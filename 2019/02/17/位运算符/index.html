<!DOCTYPE HTML>
<html lang="zh-CN">
<head><meta name="generator" content="Hexo 3.9.0">
    <!--Setting-->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta http-equiv="Cache-Control" content="no-siteapp">
    <meta http-equiv="Cache-Control" content="no-transform">
    <meta name="renderer" content="webkit|ie-comp|ie-stand">
    <meta name="apple-mobile-web-app-capable" content="RH">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="format-detection" content="telephone=no,email=no,adress=no">
    <meta name="browsermode" content="application">
    <meta name="screen-orientation" content="portrait">
    <link rel="dns-prefetch" href="http://example.com">
    <!--SEO-->





<meta name="robots" content="all">
<meta name="google" content="all">
<meta name="googlebot" content="all">
<meta name="verify" content="all">
    <!--Title-->


<title>位运算 | RH</title>


    <link rel="alternate" href="/atom.xml" title="RH" type="application/atom+xml">


    <link rel="icon" href="/img/avatar.jpg">

    



<link rel="stylesheet" href="/css/bootstrap.min.css?rev=3.3.7">
<link rel="stylesheet" href="/css/font-awesome.min.css?rev=4.5.0">
<link rel="stylesheet" href="/css/style.css?rev=@@hash">




    
	<div class="hide">
		<script type="text/javascript">
			var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan class='cnzz_stat_icon_1263868967 hide' %3E%3Cscript%20src%3D%22https%3A%2F%2Fs95.cnzz.com%2Fz_stat.php%3Fweb_id%3D1272564536%22%3E%3C%2Fscript%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s19.cnzz.com/z_stat.php%3Fid%3D1263868967%26show%3Dpic1' type='text/javascript'%3E%3C/script%3E"));
		</script>
	</div>






    

</head>

</html>
<!--[if lte IE 8]>
<style>
    html{ font-size: 1em }
</style>
<![endif]-->
<!--[if lte IE 9]>
<div style="ie">你使用的浏览器版本过低，为了你更好的阅读体验，请更新浏览器的版本或者使用其他现代浏览器，比如Chrome、Firefox、Safari等。</div>
<![endif]-->

<body>
    <header class="main-header"  style="background-image:url(http://snippet.shenliyang.com/img/banner.jpg)"  >
    <div class="main-header-box">
        <a class="header-avatar" href="/" title='RH'>
            <img src="/img/avatar.jpg" alt="logo头像" class="img-responsive center-block">
        </a>
        <div class="branding">
        	<!--<h2 class="text-hide">Snippet主题,从未如此简单有趣</h2>-->
            
                <h2> 记录一下学习、工作笔记 </h2>
            
    	</div>
    </div>
</header>
    <nav class="main-navigation">
    <div class="container">
        <div class="row">
            <div class="col-sm-12">
                <div class="navbar-header"><span class="nav-toggle-button collapsed pull-right" data-toggle="collapse" data-target="#main-menu" id="mnav">
                    <span class="sr-only"></span>
                        <i class="fa fa-bars"></i>
                    </span>
                    <a class="navbar-brand" href="http://example.com">RH</a>
                </div>
                <div class="collapse navbar-collapse" id="main-menu">
                    <ul class="menu">
                        
                            <li role="presentation" class="text-center">
                                <a href="/"><i class="fa "></i>首页</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/前端/"><i class="fa "></i>前端</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/后端/"><i class="fa "></i>后端</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/categories/其它/"><i class="fa "></i>其它</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/archives/"><i class="fa "></i>时间轴</a>
                            </li>
                        
                    </ul>
                </div>
            </div>
        </div>
    </div>
</nav>
    <section class="content-wrap">
        <div class="container">
            <div class="row">
                <main class="col-md-8 main-content m-post">
                    <p id="process"></p>
<article class="post">
    <div class="post-head">
        <h1 id="位运算">
            
	            位运算
            
        </h1>
        <div class="post-meta">
    
    
    <span class="categories-meta fa-wrap">
        <i class="fa fa-folder-open-o"></i>
        <a href="/categories/其它">
            其它
        </a>
    </span>
    

    
    <span class="fa-wrap">
        <i class="fa fa-tags"></i>
        <span class="tags-meta">
            
                
                    <a href="/tags/位运算" title='位运算'>
                        位运算
                    </a>
                
            
        </span>
    </span>
    

    
        
        <span class="fa-wrap">
            <i class="fa fa-clock-o"></i>
            <span class="date-meta">2019/02/17</span>
        </span>
        
    
</div>

            
            
            <p class="fa fa-exclamation-triangle warning">
                本文于<strong>782</strong>天之前发表，文中内容可能已经过时。
            </p>
        
    </div>
    
    <div class="post-body post-content">
        <p>下面的a和b都是整数类型，则：</p>
<table>
<thead>
<tr>
<th><strong>含义</strong></th>
<th><a href="https://baike.baidu.com/item/Pascal%E8%AF%AD%E8%A8%80" target="_blank" rel="noopener">Pascal语言</a></th>
<th>C语言</th>
<th style="text-align:left">C#语言</th>
<th>Java</th>
</tr>
</thead>
<tbody>
<tr>
<td>按位与</td>
<td>a and b</td>
<td>a &amp; b</td>
<td style="text-align:left">a &amp; b</td>
<td>a &amp; b</td>
</tr>
<tr>
<td>按位或</td>
<td>a or b</td>
<td>a &#124; b</td>
<td style="text-align:left">a &#124; b</td>
<td>a &#124; b</td>
</tr>
<tr>
<td>按位异或</td>
<td>a xor b</td>
<td>a ^ b</td>
<td style="text-align:left">a ^ b</td>
<td>a ^ b</td>
</tr>
<tr>
<td>按位取反</td>
<td>not a</td>
<td>~a</td>
<td style="text-align:left">~a</td>
<td>~a</td>
</tr>
<tr>
<td>左移</td>
<td>a shl b</td>
<td>a &lt;&lt; b</td>
<td style="text-align:left">a &lt;&lt; b</td>
<td>a &lt;&lt; b</td>
</tr>
<tr>
<td>带符号右移</td>
<td>a shr b</td>
<td>a &gt;&gt; b</td>
<td style="text-align:left">a &gt;&gt; b</td>
<td>a &gt;&gt; b</td>
</tr>
<tr>
<td>无符号右移</td>
<td></td>
<td></td>
<td style="text-align:left"></td>
<td>a&gt;&gt;&gt; b</td>
</tr>
</tbody>
</table>
<h2 id="运算说明"><a href="#运算说明" class="headerlink" title="运算说明"></a>运算说明</h2><p>=== 1. and运算 &amp; ===</p>
<p>and运算通常用于二进制的取位操作，例如一个数 and 1的结果就是取二进制的最末位。这可以用来判断一个整数的奇偶，二进制的最末位为0表示该数为偶数，最末位为1表示该数为奇数。</p>
<p>相同位的两个数字都为1，则为1；若有一个不为1，则为0。</p>
<p>00101</p>
<p>11100</p>
<p>（&amp;；或者and）</p>
<hr>
<p>00100</p>
<p>=== 2. or运算 | ===</p>
<p>or运算通常用于二进制特定位上的无条件赋值，例如一个数or 1的结果就是把二进制最末位强行变成1。如果需要把二进制最末位变成0，对这个数or 1之后再减一就可以了，其实际意义就是把这个数强行变成最接近的偶数。</p>
<p>相同位只要一个为1即为1。</p>
<p>00101</p>
<p>11100</p>
<p>（|或者or）</p>
<hr>
<p>11101</p>
<p>=== 3. xor运算 ^ ===</p>
<p>异或的符号是^。按位异或运算, 对等长二进制模式按位或二进制数的每一位执行逻辑按位异或操作. 操作的结果是如果某位不同则该位为1, 否则该位为0.</p>
<p>xor运算的逆运算是它本身，也就是说两次异或同一个数最后结果不变，即（a xor b) xor b = a。xor运算可以用于简单的加密，比如我想对我MM说1314520，但怕别人知道，于是双方约定拿我的生日19880516作为<a href="https://baike.baidu.com/item/%E5%AF%86%E9%92%A5" target="_blank" rel="noopener">密钥</a>。1314520 xor 19880516 = 20665500，我就把20665500告诉MM。MM再次计算20665500 xor 19880516的值，得到1314520。</p>
<p>相同位不同则为1，相同则为0。</p>
<p>00101</p>
<p>11100</p>
<p>（^或者xor）</p>
<hr>
<p>11001</p>
<p>运算结果</p>
<p>x &lt;- x # y</p>
<p>y &lt;- x @ y</p>
<p>x &lt;- x @ y</p>
<p>执行了第一句后x变成了x # y。那么第二句实质就是y &lt;- x # y @ y，由于#和@互为逆运算，那么此时的y变成了原来的x。第三句中x实际上被赋值为（x # y) @ x，如果#运算具有交换律，那么赋值后x就变成最初的y了。这三句话的结果是，x和y的位置互换了。</p>
<p>加法和减法互为逆运算，并且加法满足交换律。把#换成+，把@换成-，我们可以写出一个不需要临时变量的swap过程（Pascal）。</p>
<p>procedure swap(var a,b:longint);</p>
<p>begin</p>
<p>a:=a + b;</p>
<p>b:=a - b;</p>
<p>a:=a - b;</p>
<p>end;</p>
<p>好了，刚才不是说xor的逆运算是它本身吗？于是我们就有了一个看起来非常诡异的swap过程：</p>
<p>procedure swap(var a,b:longint);</p>
<p>begin</p>
<p>a:=a xor b;</p>
<p>b:=a xor b;</p>
<p>a:=a xor b;</p>
<p>end;</p>
<p>注意：位运算版本的交换两数不适用于一个数的自我交换。也就是说，如果上述程序的“b”改成“a”的话，其结果是变量a变成零。因此，在使用快速排序时，由于涉及到一个数的自我交换，因此如果要在其中使用位运算版的交换两数的话，应该先判断。具体的时间损耗在此略过。</p>
<p>=== 4. not运算 ~ ===</p>
<p>not运算的定义是把内存中的0和1全部取反。使用not运算时要格外小心，你需要注意整数类型有没有符号。如果not的对象是<a href="https://baike.baidu.com/item/%E6%97%A0%E7%AC%A6%E5%8F%B7%E6%95%B4%E6%95%B0" target="_blank" rel="noopener">无符号整数</a>（不能表示负数），那么得到的值就是它与该类型上界的差，因为无符号类型的数是用00到$FFFF依次表示的。下面的两个程序（仅语言不同）均返回65435。</p>
<p>var</p>
<p>a:word;</p>
<p>begin</p>
<p>a:=100;</p>
<p>a:=not a;</p>
<p>writeln(a);</p>
<p>end.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">unsigned</span> short a=<span class="number">100</span>;</span><br><span class="line">    a=~a;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,a);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如果not的对象是有符号的整数，情况就不一样了，稍后我们会在“整数类型的储存”小节中提到。</p>
<p>=== 5. shl运算 &lt;&lt; ===</p>
<p>a shl b就表示把a转为二进制后左移b位（在后面添b个0）。例如100的二进制为1100100，而110010000转成十进制是400，那么100 shl 2 = 400。可以看出，a shl b的值实际上就是a乘以2的b次方，因为在二进制数后添一个0就相当于该数乘以2。</p>
<p>通常认为a shl 1比a * 2更快，因为前者是更底层一些的操作。因此程序中乘以2的操作请尽量用左移一位来代替。</p>
<p>定义一些常量可能会用到shl运算。你可以方便地用1 shl 16 - 1来表示65535。很多算法和数据结构要求数据规模必须是2的幂，此时可以用shl来定义Max_N等常量。</p>
<p>=== 6. shr运算 &gt;&gt; ===</p>
<p>和shl相似，a shr b表示二进制右移b位（去掉末b位），相当于a除以2的b次方（取整）。我们也经常用shr 1来代替div 2，比如<a href="https://baike.baidu.com/item/%E4%BA%8C%E5%88%86%E6%9F%A5%E6%89%BE" target="_blank" rel="noopener">二分查找</a>、堆的插入操作等等。想办法用shr代替除法运算可以使程序效率大大提高。最大公约数的二进制算法用除以2操作来代替慢得出奇的mod运算，效率可以提高60%。</p>
<h2 id="优先级"><a href="#优先级" class="headerlink" title="优先级"></a>优先级</h2><p>C语言中位运算符之间，按优先级顺序排列为</p>
<table>
<thead>
<tr>
<th>1</th>
<th>~</th>
</tr>
</thead>
<tbody>
<tr>
<td>2</td>
<td>&lt;&lt;、&gt;&gt;</td>
</tr>
<tr>
<td>3</td>
<td>&amp;</td>
</tr>
<tr>
<td>4</td>
<td>^</td>
</tr>
<tr>
<td>5</td>
<td>&#124;</td>
</tr>
<tr>
<td>6</td>
<td>&amp;=、^=、&#124;=、&lt;&lt;=、&gt;&gt;=</td>
</tr>
</tbody>
</table>
<h2 id="右移运算-gt-gt"><a href="#右移运算-gt-gt" class="headerlink" title="右移运算(&gt;&gt;)"></a>右移运算(&gt;&gt;)</h2><p>右移运算符是将一个二进制数按指定移动的位数向右移动。</p>
<p>移动过程中，正数最高位补0，负数最高位补1，无符号数最高位补0。</p>
<p><strong>补码</strong></p>
<p>在计算机系统中，数值一律用补码来表示和存储，其中最高位表示符号位，1表示负数，0表示正数。</p>
<p>· 正数的补码是原码自身。</p>
<p>· 负数补码是通过原码计算得到，计算过程为：符号位不变，其余位按照原码取反加1</p>
<p><strong>补码计算示例</strong></p>
<p>以计算十进制-100的补码为例，计算过程为：</p>
<p>-100的原码：                   10000000 00000000 00000000 01100100<br>符号位保持不变，取反：11111111 11111111 11111111 10011011<br>加1后，-100补码为：     11111111 11111111 11111111 10011100</p>
<p>下面右移都是以整数为例，不考虑小数情况。</p>
<p><strong>正数右移</strong></p>
<p>正数右移高位需补0，以100右移4位为例：</p>
<table>
<thead>
<tr>
<th><strong>操作</strong></th>
<th><strong>二进制</strong></th>
<th><strong>对应十进制</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>补码</td>
<td>00000000 00000000 00000000 01100100</td>
<td>100</td>
</tr>
<tr>
<td>右移4位</td>
<td>00000000 00000000 00000000 00000110</td>
<td>6</td>
</tr>
<tr>
<td>源码</td>
<td>00000000 00000000 00000000 00000110</td>
<td>6</td>
</tr>
</tbody>
</table>
<p>最后可得: 100 &gt;&gt; 4 = 6</p>
<p>正数的右移相当于除法，右移几位就除以2的几次方，如100&gt;&gt;4 等效 100/2^4</p>
<p><strong>负数右移</strong></p>
<p>负数右移高位需补1，以-100右移4位为例：</p>
<table>
<thead>
<tr>
<th><strong>操作</strong></th>
<th><strong>二进制</strong></th>
<th><strong>对应十进制</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>原码</td>
<td>10000000 00000000 00000000 01100100</td>
<td>-100</td>
</tr>
<tr>
<td>转换为补码</td>
<td>11111111 11111111 11111111 10011100</td>
<td>-100</td>
</tr>
<tr>
<td>右移4位，高位补1</td>
<td>11111111 11111111 11111111 11111001</td>
<td></td>
</tr>
<tr>
<td>保留符号位，按位取反</td>
<td>10000000 00000000 00000000 00000110</td>
<td></td>
</tr>
<tr>
<td>加1后转为源码</td>
<td>10000000 00000000 00000000 00000111</td>
<td>-7</td>
</tr>
</tbody>
</table>
<p>最后可得： -100 &gt;&gt; 4 = -7</p>
<p>负数的右移不等于除法，即负数右移不能按除以2的n次方计算（n表示移动位数）。</p>
<p><strong>无符号右移</strong></p>
<p>无符号右移和正数右移相同，都是高位补0，以-100右移4位为例：</p>
<table>
<thead>
<tr>
<th><strong>操作</strong></th>
<th><strong>二进制</strong></th>
<th><strong>对应十进制</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>原码</td>
<td>10000000 00000000 00000000 01100100</td>
<td>-100</td>
</tr>
<tr>
<td>转换为补码</td>
<td>11111111 11111111 11111111 10011100</td>
<td>-100</td>
</tr>
<tr>
<td>右移4位，高位补0</td>
<td>00001111 11111111 11111111 11111001</td>
<td></td>
</tr>
<tr>
<td>转为原码</td>
<td>00001111 11111111 11111111 11111001</td>
<td>268435449</td>
</tr>
</tbody>
</table>
<p>最后可得： -100 &gt;&gt;&gt; 4 = 268435449</p>
<p>右移28位后，最高位为0表示正数，所以原码即为补码本身。<br>“&gt;&gt;&gt;”是Java里的无符号右移操作符。</p>
<p>总结</p>
<p>正数的右移，负数的无符号右移，就是相应的补码移位所得，在高位补0即可。<br>负数的右移，就是补码高位补1,然后按位取反加1即可。</p>
<h2 id="左移运算-lt-lt"><a href="#左移运算-lt-lt" class="headerlink" title="左移运算(&lt;&lt;)"></a>左移运算(&lt;&lt;)</h2><p>运算规则：</p>
<p>按二进制形式把所有的数字向左移动对应的位数，高位移出(舍弃)，低位的空位补零。</p>
<p>语法格式：</p>
<p>需要移位的数字 &lt;&lt; 移位的次数</p>
<p>例如： 3 &lt;&lt; 2，则是将数字3左移2位</p>
<p>计算过程：</p>
<p>3 &lt;&lt; 2 首先把3转换为二进制数字0000 0011，然后把该数字高位(左侧)的两个零移出，其他的数字都朝左平移2位，最后在低位(右侧)的两个空位补零。则得到的最终结果是0000 1100，则转换为十进制是12。</p>
<p>数学意义：</p>
<p>在数字没有溢出的前提下，对于正数和负数，左移一位都相当于乘以2的1次方，左移n位就相当于乘以2的n次方。</p>

    </div>
    
        <div class="reward">
    <div class="reward-wrap">赏
        <div class="reward-box">
            
                <span class="reward-type">
                    <img class="alipay" src="/img/ali.png"><b>支付宝</b>
                </span>
            
            
        </div>
    </div>
    <p class="reward-tip">扫上面二维码，领支付宝红包</p>
</div>


    
    <div class="post-footer">
        <div>
            
                转载声明：商业转载请联系作者获得授权,非商业转载请注明出处 © <a href="" target="_blank">RH</a>
            
        </div>
        <div>
            
        </div>
    </div>
</article>

<div class="article-nav prev-next-wrap clearfix">
    
        <a href="/2019/02/18/深拷贝与浅拷贝/" class="pre-post btn btn-default" title='深拷贝与浅拷贝'>
            <i class="fa fa-angle-left fa-fw"></i><span class="hidden-lg">上一篇</span>
            <span class="hidden-xs">深拷贝与浅拷贝</span>
        </a>
    
    
        <a href="/2019/02/16/react-native-problem2/" class="next-post btn btn-default" title='The component for route must be a react component'>
            <span class="hidden-lg">下一篇</span>
            <span class="hidden-xs">The component for route must be a react component</span><i class="fa fa-angle-right fa-fw"></i>
        </a>
    
</div>


    <div id="comments">
        
    
    <div id="vcomments" class="valine"></div>
    <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src="/assets/valine.min.js"></script>

    <script>
        new Valine({
            av: AV,
            el: '#vcomments',
            appId: 'tpqT2XsfMpVPjR2x4Ou2Hfgk-gzGzoHsz',
            appKey: 'zVoewkC4BTgyKYFCxAG8V2tO',
            placeholder: '说点什么吧',
            notify: false,
            verify: false,
            avatar: 'mm',
            meta: 'nick,mail'.split(','),
            pageSize: '10',
            path: window.location.pathname,
            lang: 'zh-CN'.toLowerCase()
        })
    </script>


    </div>





                </main>
                
                    <aside id="article-toc" role="navigation" class="col-md-4">
    <div class="widget">
        <h3 class="title">文章目录</h3>
        
            <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#运算说明"><span class="toc-text">运算说明</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#优先级"><span class="toc-text">优先级</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#右移运算-gt-gt"><span class="toc-text">右移运算(&gt;&gt;)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#左移运算-lt-lt"><span class="toc-text">左移运算(&lt;&lt;)</span></a></li></ol>
        
    </div>
</aside>

                
            </div>
        </div>
    </section>
    <footer class="main-footer">
    <div class="container">
        <div class="row">
        </div>
    </div>
</footer>

<a id="back-to-top" class="icon-btn hide">
	<i class="fa fa-chevron-up"></i>
</a>




    <div class="copyright">
    <div class="container">
        <div class="row">
            <div class="col-sm-12">
                <div class="busuanzi">
    
</div>

            </div>
            <div class="col-sm-12">
                <span>Copyright &copy; 2017
                </span> |
                <span>
                    Powered by <a href="//hexo.io" class="copyright-links" target="_blank" rel="nofollow">Hexo</a>
                </span> |
                <span>
                    Theme by <a href="//github.com/shenliyang/hexo-theme-snippet.git" class="copyright-links" target="_blank" rel="nofollow">Snippet</a>
                </span>
            </div>
        </div>
    </div>
</div>







<script src="/js/app.js?rev=@@hash"></script>

</body>
</html>